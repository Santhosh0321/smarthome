<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SentinelHome - Cloud Dashboard</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0c1f 0%, #1a1a2e 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .header h1 {
            font-size: 2.2em;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .connection-status {
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 600;
        }
        
        .status-connected {
            background: rgba(76, 175, 80, 0.2);
            color: #4caf50;
            border: 1px solid #4caf50;
        }
        
        .status-disconnected {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        .emergency-banner {
            background: rgba(244, 67, 54, 0.3);
            border: 2px solid #f44336;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .card-header h3 {
            font-size: 1.2em;
        }
        
        .relay-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 10px 0;
        }
        
        .relay-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .led {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .led.on {
            background: #4caf50;
            box-shadow: 0 0 10px #4caf50;
        }
        
        .led.off {
            background: #f44336;
        }
        
        .led.emergency {
            background: #ff9800;
            box-shadow: 0 0 10px #ff9800;
        }
        
        .sensor-row {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .value {
            font-weight: bold;
            color: #4caf50;
        }
        
        .buzzer-active {
            color: #ff9800;
            font-weight: bold;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #888;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè† SentinelHome Cloud</h1>
            <div id="connectionStatus" class="connection-status status-disconnected">
                üî¥ Disconnected
            </div>
        </div>
        
        <div id="emergencyBanner" style="display: none;" class="emergency-banner">
            üö®üö® FIRE EMERGENCY ACTIVE! üö®üö®<br>
            All non-emergency relays are OFF. Emergency relay is ON.
        </div>
        
        <div class="grid">
            <!-- Relays Card -->
            <div class="card">
                <div class="card-header">
                    <h3>‚ö° Relay States</h3>
                </div>
                <div class="relay-row">
                    <div class="relay-status">
                        <span id="relay1Led" class="led off"></span>
                        Light (Relay1)
                    </div>
                    <span id="relay1Status">OFF</span>
                </div>
                <div class="relay-row">
                    <div class="relay-status">
                        <span id="relay2Led" class="led off"></span>
                        Fan (Relay2)
                    </div>
                    <span id="relay2Status">OFF</span>
                </div>
                <div class="relay-row">
                    <div class="relay-status">
                        <span id="relay3Led" class="led off"></span>
                        Motor (Relay3)
                    </div>
                    <span id="relay3Status">OFF</span>
                </div>
                <div class="relay-row">
                    <div class="relay-status">
                        <span id="relay4Led" class="led off"></span>
                        Emergency (Relay4)
                    </div>
                    <span id="relay4Status">OFF</span>
                </div>
            </div>
            
            <!-- Sensors Card -->
            <div class="card">
                <div class="card-header">
                    <h3>üìä Sensor Data</h3>
                </div>
                <div class="sensor-row">
                    <span>üî• Fire:</span>
                    <span id="fireStatus">No</span>
                </div>
                <div class="sensor-row">
                    <span>üí® Smoke:</span>
                    <span id="smokeStatus">No</span>
                </div>
                <div class="sensor-row">
                    <span>üåßÔ∏è Rain:</span>
                    <span id="rainStatus">No</span>
                </div>
                <div class="sensor-row">
                    <span>üì≥ Vibration:</span>
                    <span id="vibrationStatus">0/5</span>
                </div>
                <div class="sensor-row">
                    <span>üö∂ Motion:</span>
                    <span id="motionStatus">No</span>
                </div>
                <div class="sensor-row">
                    <span>üíß Water Level:</span>
                    <span id="waterLevel">0%</span>
                </div>
                <div class="sensor-row">
                    <span>‚òÄÔ∏è Light Level:</span>
                    <span id="lightLevel">0%</span>
                </div>
                <div class="sensor-row">
                    <span>üå°Ô∏è Temperature:</span>
                    <span id="temperature">0¬∞C</span>
                </div>
                <div class="sensor-row">
                    <span>üíß Humidity:</span>
                    <span id="humidity">0%</span>
                </div>
            </div>
            
            <!-- System Status Card -->
            <div class="card">
                <div class="card-header">
                    <h3>üîî System Status</h3>
                </div>
                <div class="sensor-row">
                    <span>üö® Emergency Active:</span>
                    <span id="emergencyActive">No</span>
                </div>
                <div class="sensor-row">
                    <span>üîä Buzzer:</span>
                    <span id="buzzerActive">Inactive</span>
                </div>
                <div class="sensor-row">
                    <span>üì¢ Buzzer Reason:</span>
                    <span id="buzzerReason">--</span>
                </div>
                <div class="sensor-row">
                    <span>‚öôÔ∏è Motor Auto Mode:</span>
                    <span id="motorAutoMode">Enabled</span>
                </div>
            </div>
        </div>
        
        <div class="footer">
            SentinelHome - Real-time Cloud Monitoring
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCLdL4teSGiF8f0M5q9LaXoXd1mPoq9lMY",
            authDomain: "smart-home-dd7e5.firebaseapp.com",
            databaseURL: "https://smart-home-dd7e5-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "smart-home-dd7e5",
            storageBucket: "smart-home-dd7e5.firebasestorage.app",
            messagingSenderId: "230561792370",
            appId: "1:230561792370:web:f951f576564cb076401deb"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Connection Status
        const connectionStatus = document.getElementById('connectionStatus');
        db.ref('.info/connected').on('value', (snap) => {
            if (snap.val()) {
                connectionStatus.className = 'connection-status status-connected';
                connectionStatus.innerHTML = 'üü¢ Connected';
            } else {
                connectionStatus.className = 'connection-status status-disconnected';
                connectionStatus.innerHTML = 'üî¥ Disconnected';
            }
        });

        // Monitor Relay States
        for (let i = 1; i <= 4; i++) {
            db.ref(`/relay${i}`).on('value', (snapshot) => {
                const state = snapshot.val();
                document.getElementById(`relay${i}Status`).textContent = state ? 'ON' : 'OFF';
                document.getElementById(`relay${i}Led`).className = state ? 'led on' : 'led off';
            });
        }

        // Monitor Fire Status
        db.ref('/sensors/fire').on('value', (snapshot) => {
            document.getElementById('fireStatus').textContent = snapshot.val() ? 'YES' : 'No';
        });

        db.ref('/sensors/fireActive').on('value', (snapshot) => {
            const active = snapshot.val();
            document.getElementById('emergencyActive').textContent = active ? 'YES' : 'No';
            document.getElementById('emergencyBanner').style.display = active ? 'block' : 'none';
        });

        // Monitor Smoke
        db.ref('/sensors/smoke').on('value', (snapshot) => {
            document.getElementById('smokeStatus').textContent = snapshot.val() ? 'YES' : 'No';
        });

        // Monitor Rain
        db.ref('/sensors/rain').on('value', (snapshot) => {
            document.getElementById('rainStatus').textContent = snapshot.val() ? 'YES' : 'No';
        });

        // Monitor Vibration
        db.ref('/sensors/vibrationCount').on('value', (snapshot) => {
            const count = snapshot.val() || 0;
            db.ref('/sensors/vibration').on('value', (alertSnap) => {
                const alert = alertSnap.val();
                document.getElementById('vibrationStatus').textContent = count + '/5 ' + (alert ? '‚ö†Ô∏è' : '');
            });
        });

        // Monitor Motion
        db.ref('/sensors/motion').on('value', (snapshot) => {
            document.getElementById('motionStatus').textContent = snapshot.val() ? 'YES' : 'No';
        });

        // Monitor Water Level
        db.ref('/sensors/water').on('value', (snapshot) => {
            document.getElementById('waterLevel').textContent = (snapshot.val() || 0) + '%';
        });

        // Monitor Light Level
        db.ref('/sensors/light').on('value', (snapshot) => {
            document.getElementById('lightLevel').textContent = (snapshot.val() || 0) + '%';
        });

        // Monitor Temperature
        db.ref('/sensors/temperature').on('value', (snapshot) => {
            document.getElementById('temperature').textContent = (snapshot.val() || 0).toFixed(1) + '¬∞C';
        });

        // Monitor Humidity
        db.ref('/sensors/humidity').on('value', (snapshot) => {
            document.getElementById('humidity').textContent = (snapshot.val() || 0).toFixed(1) + '%';
        });

        // Monitor Buzzer
        db.ref('/sensors/buzzerActive').on('value', (snapshot) => {
            const active = snapshot.val();
            document.getElementById('buzzerActive').textContent = active ? 'Active' : 'Inactive';
        });

        db.ref('/sensors/buzzerReason').on('value', (snapshot) => {
            const reason = snapshot.val();
            document.getElementById('buzzerReason').textContent = reason || '--';
            if (reason) {
                document.getElementById('buzzerActive').className = 'buzzer-active';
            } else {
                document.getElementById('buzzerActive').className = '';
            }
        });

        // Monitor Motor Auto Mode
        db.ref('/auto/motor').on('value', (snapshot) => {
            document.getElementById('motorAutoMode').textContent = snapshot.val() ? 'Enabled' : 'Disabled';
        });

        // Monitor Emergency Status
        db.ref('/system/emergencyActive').on('value', (snapshot) => {
            const active = snapshot.val();
            if (active) {
                document.getElementById('relay4Led').className = 'led emergency';
            }
        });

        console.log('Dashboard connected to Firebase');
    </script>
</body>
</html>
